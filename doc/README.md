# BeanCKUP CLI - 高性能增量备份工具

BeanCKUP CLI 是一款为开发者和高级用户设计的**跨平台命令行备份工具**。它通过先进的增量备份算法和并发处理技术，实现了极致的扫描速度和备份效率。

---

## 🌟 核心特性

### 🔍 高速并发扫描（全新优化）
- 采用 **生产者-消费者模型**
- 充分利用多核 CPU 和高速 SSD 的性能
- 并行化 I/O 和哈希计算，大幅提升扫描速度
- 即使面对数百万文件也能从容应对

### 💾 智能增量备份
- 通过“五元预筛”（路径、大小、时间戳等）快速判断文件是否变化
- 对可疑文件使用 SHA256 哈希校验，精确识别变动
- 只有真正新增或修改的文件会被物理打包，节省存储空间和备份时间

### 🧭 精确文件溯源
- 每个文件在清单（Manifest）中都有一个 `reference` 字段，格式为：  
  `包名.7z/文件在包内的路径`
- 这是实现可靠恢复的基石，确保任何文件都能被准确无误地找到

### 📦 原子化交付计划
- 所有交付操作都支持断点续传
- 即使程序中途退出，下次运行时也会自动检测未完成任务，并提示继续或重新开始
- 确保交付状态的完整性

### 🔁 可靠的文件恢复
- 恢复流程严格按照清单的 `reference` 字段执行，逻辑清晰无歧义
- 在目标目录下创建临时文件夹，解决跨盘恢复失败问题
- 能完整重现指定备份时间点的工作区全貌（包括 `.beanckup` 历史记录）

### 📊 实时进度反馈
- 扫描与打包过程中提供实时、平滑刷新的单行进度条
- 直观了解当前状态，告别“干等”

### ⚙️ 灵活的交付选项
- 支持按大小自动分卷打包
- 可限制单次交付总体积
- 支持设置不同压缩级别
- 支持添加密码进行加密，满足多样化的归档和传输需求

---

## 🚀 快速开始

请参考 [TECH_DOC.md](TECH_DOC.md) 中的 **快速上手指南** 部分，获取安装、编译和基本使用步骤。

---

## 🧠 软件如何工作？

BeanCKUP 的核心是其 **清单（Manifest）系统**。

### 1. 扫描与识别
- 执行扫描时，程序会高速并行检查文件
- 优先通过元数据（大小、修改时间等）判断文件是否未变
- 对于元数据有变化或路径找不到的文件，才会计算其“指纹”（SHA256 哈希），并与历史记录比对
- 精确识别出哪些是真正的新增文件，哪些只是被移动或重命名

### 2. 打包与记录
- 只有“新增文件”才会被物理压缩进新的交付包（`.7z` 文件）
- 每个交付包都会附带一份自己的清单（Manifest）
- 清单记录了当前工作区的完整文件列表
- 每个文件的 `reference` 字段标明其物理位置（哪个交付包、包内路径）

### 3. 恢复
- 恢复时加载对应版本的所有清单，生成完整的文件“地图”
- 严格按地图从不同交付包中提取所需文件
- 完美还原当时的文件结构
- 所有历史清单也被一并恢复，使得恢复出的文件夹可直接用于下一次备份

---

## 📁 目录结构

- `main.go`: 主程序入口，负责菜单交互与流程调度。
- `internal/`: 存放所有核心模块的目录，具体技术细节请参考 [TECH_DOC.md](TECH_DOC.md)